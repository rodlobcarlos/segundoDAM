package proyectoMongoDB_service;

import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

import proyectoMongoDB_model.Configuracion_IA;
import proyectoMongoDB_model.ProyectoException;
import proyectoMongoDB_model.Tarea;
import proyectoMongoDB_model.Usuario;
import proyectoMongoDB_repository.Usuario_repository;

public class Usuario_service {

	private static final Logger logger = LogManager.getLogger(Usuario_service.class);
	private Usuario_repository repo;

	public Usuario_repository getRepo() {
		return repo;
	}

	public void setRepo(Usuario_repository repo) {
		this.repo = repo;
	}

	public Usuario_service(Usuario_repository repo) {
		super();
		this.repo = repo;
	}

	@Override
	public String toString() {
		return "Usuario_service [repo=" + repo + "]";
	}

	public void save(Usuario u) {
		repo.save(u);
	}

	public List<Usuario> read() {
		return repo.read();
	}

	public void delete(Usuario u) {
		try {
			repo.delete(u);
		} catch (ProyectoException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

	public void update(Usuario u) {
		try {
			repo.update(u);
		} catch (ProyectoException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

	public Usuario filtradosPorId(String id) {
		return repo.getUsuariosFiltradosPorId(id);
	}

	public List<Usuario> filtrarPorUsuariosVarios(String id, Configuracion_IA ia, Tarea nuevaTarea) {
		List<Usuario> usuarios = new ArrayList<Usuario>();
		for (Usuario usuario : repo.getUsuario()) {
			if (usuario.getId().equals(id) || usuario.getIa().getIdioma_preferido().equals(ia.getIdioma_preferido())
					|| usuario.getEmail().equals(nuevaTarea)) {
				logger.info("Usuario encontrado -> " + usuario.getNombre_usuario() + " " + usuario.getId());
				usuarios.add(usuario);
			}
		}
		return usuarios;
	}

	public List<Usuario> ordenarUsuarioPorId(Usuario u) {
		return Collections.sort(repo.getUsuario());
		
	}
}
